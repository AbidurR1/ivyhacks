!pip install tensorflow-gpu
print(tf.__version__)
import numpy as np
import pandas as pd
import seaborn as sns
from google.colab import files
uploaded = files.upload()


df= pd.read_csv('/content/cardio_train.csv', sep=';')
df.head(18)

df.shape
df.isna().sum()
df.isnull().values.any()
df.describe()

sns.countplot(df['cardio'])
df['years']=(df['age']/365).round(0)
df['years']=pd.to_numeric(df['years'], downcast='integer')

df.corr()

import matplotlib.pyplot as plt
plt.figure(figsize=(10,10))
sns.heatmap(df.corr(), annot=True, fmt= '.1%')

df= df.drop('years', axis=1)
df = df.drop('id', axis=1)

X = df.iloc[:,:-1].values
Y= df.iloc[:, -1].values

from sklearn.model_selection import train_test_split
X_train, X_test, Y_train, Y_test = train_test_split(X,Y, test_size=0.25, random_state=1)

from sklearn.preprocessing import StandardScaler
sc = StandardScaler()
X_train= sc.fit_transform(X_train)
X_test= sc.transform(X_test)


from sklearn.ensemble import RandomForestClassifier
forest = RandomForestClassifier(n_estimators =10, criterion ='entropy', random_state=1)
forest.fit(X_train, Y_train)

model =forest
model.score(X_train, Y_train)

from sklearn.metrics import confusion_matrix
cm= confusion_matrix(Y_test, model.predict(X_test))

TN = cm[0][0]
TP = cm[1][1]
FN = cm[1][0]
FP = cm[0][1]

print(cm)
print('Model Test Accuracy ={}'. format((TP+TN)/(TP+TN+FN+FP)))

from sklearn.neighbors import KNeighborsClassifier
df.head()
df.hist()

